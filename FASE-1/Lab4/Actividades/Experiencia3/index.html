<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Experiencia de Práctica Nº 03 — Uso de Funciones (JS)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; line-height: 1.5; }
    header h1 { margin-bottom: .25rem; }
    header p { margin-top: 0; color: #555; }
    .panel { border: 1px solid #ddd; border-radius: 10px; padding: 1rem; margin: 1rem 0; }
    .btns { display: flex; flex-wrap: wrap; gap: .5rem; margin-top: .5rem; }
    button { padding: .5rem .9rem; border-radius: 8px; border: 1px solid #ccc; cursor: pointer; }
    #screenlog { background: #0b1020; color: #cfe3ff; padding: 1rem; min-height: 200px; white-space: pre-wrap; border-radius: 10px; }
    code { background: #f6f8fa; padding: .1rem .3rem; border-radius: 4px; }
  </style>
</head>
<body>
  <header>
    <h1>Experiencia de Práctica Nº 03: Uso de funciones</h1>
    <p>Guía de Prácticas — Fundamentos de JavaScript I</p>
  </header>

  <main>
    <!-- Consola en pantalla -->
    <section class="panel">
      <h2>Consola en pantalla</h2>
      <div id="screenlog" aria-live="polite"></div>
      <div class="btns">
        <button onclick="clearScreen()">Limpiar pantalla</button>
        <button onclick="console.clear(); log('Consola del navegador limpiada.')">Limpiar consola del navegador</button>
      </div>
    </section>

    <!-- (a) CIUDADANO DE PRIMERA CLASE -->
    <section class="panel" id="a-first-class">
      <h2>a) Ciudadano de primera clase</h2>
      <p>Ejecuta los dos ejemplos del PDF (función en variable y función como argumento).</p>
      <div class="btns">
        <button onclick="demoA_1()">foo() en variable</button>
        <button onclick="demoA_2()">greeting(sayHello, 'JavaScript!')</button>
      </div>
    </section>

    <!-- (b) CLOSURE -->
    <section class="panel" id="b-closure">
      <h2>b) Closure</h2>
      <p>Ejecuta <code>makeFunc()</code> y luego la función devuelta para mostrar el cierre.</p>
      <div class="btns">
        <button onclick="demoB()">Ejecutar closure</button>
      </div>
    </section>

    <!-- (c) ÁMBITO DE FUNCIÓN (+ try/catch/finally del ejemplo f) -->
    <section class="panel" id="c-scope">
      <h2>c) Ámbito de función</h2>
      <p>Ejecuta los dos ejemplos de ámbito y el ejemplo con <code>try...catch...finally</code>.</p>
      <div class="btns">
        <button onclick="demoC_1()">exampleFunction() (x adentro)</button>
        <button onclick="demoC_2()">exampleFunction() (x afuera)</button>
        <button onclick="demoC_3()">f() con try/catch/finally</button>
      </div>
    </section>

    <!-- (d) MANEJO DE EXCEPCIONES -->
    <section class="panel" id="d-exceptions">
      <h2>d) Manejo de excepciones</h2>
      <p>Ejecuta <code>UserException</code> + <code>getMonthName</code> con <code>try...catch</code> como en la guía.</p>
      <div class="btns">
        <button onclick="demoD()">Probar getMonthName(15)</button>
      </div>
    </section>
  </main>

  <script>
    // Utilidades: log a pantalla + consola
    const screen = document.getElementById('screenlog');
    function log(...args) {
      console.log(...args);
      const msg = args.map(a => {
        try { return typeof a === 'object' ? JSON.stringify(a) : String(a); }
        catch { return String(a); }
      }).join(' ');
      screen.textContent += msg + '\n';
    }
    function clearScreen(){ screen.textContent = ''; }

    // (a) Ciudadano de primera clase — Snippet 1 (const foo = () => { ... }; foo();)
    function demoA_1() {
      log('--- (a.1) foo() como función en variable ---');
      const foo = () => {
        console.log("foobar");
        log("foobar");
      };
      foo(); // Invoke it using the variable
      log('--- Fin (a.1) ---');
    }

    // (a) Ciudadano de primera clase — Snippet 2 (sayHello + greeting)
    function demoA_2() {
      log('--- (a.2) Pasar función como argumento ---');
      function sayHello() { return "Hello, "; }
      function greeting(helloMessage, name) {
        const out = helloMessage() + name;
        console.log(out);
        log(out);
      }
      greeting(sayHello, "JavaScript!");
      log('--- Fin (a.2) ---');
    }

    // (b) Closure — makeFunc / displayName
    function demoB() {
      log('--- (b) Closure: makeFunc / displayName ---');
      function makeFunc() {
        const name = 'Mozilla';
        function displayName() {
          console.log(name);
          log(name);
        }
        return displayName;
      }
      const myFunc = makeFunc();
      myFunc();
      log('--- Fin (b) ---');
    }

    // (c.1) Ámbito de función — x declarada adentro
    function demoC_1() {
      log('--- (c.1) Ámbito: x declarada adentro ---');
      function exampleFunction() {
        const x = "declared inside function";  // x solo dentro
        console.log("Inside function");
        console.log(x);
        log("Inside function");
        log(x);
      }
      try {
        console.log(x);   // Error
        log(x);
      } catch (e) {
        log('Fuera: ReferenceError (x no está definida aquí).');
      }
      exampleFunction();
      log('--- Fin (c.1) ---');
    }

    // (c.2) Ámbito de función — x declarada afuera
    function demoC_2() {
      log('--- (c.2) Ámbito: x declarada afuera ---');
      const x = "declared outside function";
      exampleFunction();
      function exampleFunction() {
        console.log("Inside function");
        console.log(x);
        log("Inside function");
        log(x);
      }
      console.log("Outside function");
      console.log(x);
      log("Outside function");
      log(x);
      log('--- Fin (c.2) ---');
    }

    // (c.3) Ejemplo f() con try/catch/finally y returns
    function demoC_3() {
      log('--- (c.3) try/catch/finally con returns ---');
      function f() {
        try {
          console.log(0); log(0);
          throw 'bogus';
        } catch (e) {
          console.log(1); log(1);
          return true;    // suspendido hasta que finally termine
          console.log(2); // no alcanzable
        } finally {
          console.log(3); log(3);
          return false;   // sobrescribe el return previo
          console.log(4); // no alcanzable
        }
        // "return false" se ejecuta antes de llegar aquí
        console.log(5); log(5); // no alcanzable
      }
      console.log(f()); // 0, 1, 3, false
      log(f());         // mostrará false
      log('--- Fin (c.3) ---');
    }

    // (d) Manejo de excepciones — UserException + getMonthName + try/catch
    function demoD() {
      log('--- (d) Manejo de excepciones: getMonthName(15) ---');
      function UserException(message) {
        this.message = message;
        this.name = 'UserException';
      }
      function getMonthName(mo) {
        mo--; // ajustar 1..12 -> 0..11
        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
        if (months[mo] !== undefined) {
          return months[mo];
        } else {
          throw new UserException('InvalidMonthNo');
        }
      }

      let monthName;
      try {
        const myMonth = 15; // fuera de rango -> lanza excepción
        monthName = getMonthName(myMonth);
      } catch (e) {
        monthName = 'unknown';
        console.error(e.message, e.name);
        log(`catch → ${e.message} ${e.name}`);
      }
      log('Resultado monthName =', monthName);
      log('--- Fin (d) ---');
    }
  </script>
</body>
</html>
